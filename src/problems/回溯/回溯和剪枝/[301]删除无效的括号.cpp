//ç»™ä½ ä¸€ä¸ªç”±è‹¥å¹²æ‹¬å·å’Œå­—æ¯ç»„æˆçš„å­—ç¬¦ä¸² s
//ï¼Œåˆ é™¤æœ€å°æ•°é‡çš„æ— æ•ˆæ‹¬å·ï¼Œä½¿å¾—è¾“å…¥çš„å­—ç¬¦ä¸²æœ‰æ•ˆã€‚
//
// è¿”å›æ‰€æœ‰å¯èƒ½çš„ç»“æœã€‚ç­”æ¡ˆå¯ä»¥æŒ‰ ä»»æ„é¡ºåº è¿”å›ã€‚
//
//
//
// ç¤ºä¾‹ 1ï¼š
//
//
//è¾“å…¥ï¼šs = "()())()"
//è¾“å‡ºï¼š["(())()","()()()"]
//
//
// ç¤ºä¾‹ 2ï¼š
//
//
//è¾“å…¥ï¼šs = "(a)())()"
//è¾“å‡ºï¼š["(a())()","(a)()()"]
//
//
// ç¤ºä¾‹ 3ï¼š
//
//
//è¾“å…¥ï¼šs = ")("
//è¾“å‡ºï¼š[""]
//
//
//
//
// æç¤ºï¼š
//
//
// 1 <= s.length <= 25
// s ç”±å°å†™è‹±æ–‡å­—æ¯ä»¥åŠæ‹¬å· '(' å’Œ ')' ç»„æˆ
// s ä¸­è‡³å¤šå« 20 ä¸ªæ‹¬å·
//
// Related Topics å¹¿åº¦ä¼˜å…ˆæœç´¢ å­—ç¬¦ä¸² å›æº¯
// ğŸ‘ 459 ğŸ‘ 0

// leetcode submit region begin(Prohibit modification and deletion)
#include <string>
#include <vector>
using std::string;
using std::vector;

/// å›æº¯ + å‰ªæ
class Solution {
 public:
  vector<string> ans;  //æ­¤æ—¶ä¸ä¼šé‡å¤æœç´¢ æ— é‡å¤æ–¹æ¡ˆ ç›´æ¥å­˜å³å¯
  void dfs(string &s, int u, string res, int cnt, int l,
           int r) {
    // cnt ä¸ºå½“å‰[å·¦-å³]çš„å€¼ l ä¸ºéœ€è¦åˆ é™¤çš„å·¦æ‹¬å·æ•°é‡ r ä¸ºå³
    if (u == s.size()) {
      if (!cnt) ans.push_back(res);
      return;
    }
    if (s[u] == '(') {  //åœ¨åˆæ³•çš„æ¡ä»¶ä¸‹è€ƒè™‘åˆ é™¤ å¯¹äºè¿ç»­çš„kä¸ª'(' åªéœ€è€ƒè™‘ä¸€æ¬¡æ€§
                        //åˆ  iä¸ª(0<=i<=k) åˆ™å¯ä»2^ké™åˆ° k
      int k = u;
      while (k < s.size() && s[k] == '(') k++;  //æ‰¾åˆ°æœ€åä¸€ä¸ªè¿ç»­çš„'('çš„å³è¾¹
      l -= k - u;  //å‡è®¾å°†è¿™äº›è¿ç»­çš„'('å…¨éƒ¨åˆ é™¤
      for (int i = k - u; i >= 0; i--) {        // iä¸ºåˆ é™¤åçš„ä½ç½®
        if (l >= 0) dfs(s, k, res, cnt, l, r);  //å¯åˆ æ—¶
        res += '(', cnt++, l++;
      }
    } else if (s[u] == ')') {  //åœ¨åˆæ³•çš„æ¡ä»¶ä¸‹è€ƒè™‘åˆ é™¤
      int k = u;
      while (k < s.size() && s[k] == ')') k++;  //æ‰¾åˆ°æœ€åä¸€ä¸ªè¿ç»­çš„'('çš„å³è¾¹
      r -= k - u;  //å‡è®¾å°†è¿™äº›è¿ç»­çš„'('å…¨éƒ¨åˆ é™¤
      for (int i = k - u; i >= 0; i--) {  // iä¸ºåˆ é™¤åçš„ä½ç½®
        if (cnt >= 0 && r >= 0) dfs(s, k, res, cnt, l, r);  //å¯åˆ æ—¶
        res += ')', cnt--, r++;
      }
    } else
      dfs(s, u + 1, res + s[u], cnt, l, r);
  }
  vector<string> removeInvalidParentheses(string s) {
    int l = 0, r = 0;  // lä¸ºå½“å‰å·¦æ‹¬å·-å³æ‹¬å·çš„å€¼ rä¸ºéœ€è¦åˆ æ‰çš„å³æ‹¬å·çš„å€¼
    for (auto v : s) {
      if (v == '(')
        l++;
      else if (v == ')') {
        if (l <= 0)
          r++;  //æ­¤æ—¶æ— æ•ˆ å³æ‹¬å· å¿…åˆ 
        else
          l--;  //å³æ‹¬å·+1 åˆ™å·¦-å³çš„å€¼éœ€è¦--
      }
    }
    //æ­¤æ—¶çš„lä¸ºéœ€è¦åˆ é™¤çš„å·¦æ‹¬å·æ•°é‡ rä¸ºéœ€è¦åˆ é™¤çš„å³æ‹¬å·æ•°é‡
    dfs(s, 0, "", 0, l, r);
    return ans;
  }
};
// leetcode submit region end(Prohibit modification and deletion)
